<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel-Tabellen • statR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Excel-Tabellen">
<meta property="og:description" content="statR">
<meta name="twitter:card" content="summary">
<meta name="theme-color" content="#293c55">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-7425245790017381",
          enable_page_level_ads: true
     });
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">statR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Excel-Tabellen.html">Excel-Tabellen</a>
    </li>
    <li>
      <a href="../articles/Visualisierungen.html">Visualisierungen</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/statistikZH/statR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Excel-Tabellen_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Excel-Tabellen</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/statistikZH/statR/blob/master/vignettes/Excel-Tabellen.Rmd"><code>vignettes/Excel-Tabellen.Rmd</code></a></small>
      <div class="hidden name"><code>Excel-Tabellen.Rmd</code></div>

    </div>

    
    
<div id="formatierte-excel-tabellen-mit-r" class="section level1">
<h1 class="hasAnchor">
<a href="#formatierte-excel-tabellen-mit-r" class="anchor"></a>Formatierte Excel-Tabellen mit R</h1>
<p><code>statR</code> enthält mehrere Funktionen, mit welchen Datensätze aus <code>R</code> als Excel-Dateien exportiert werden können. Die Funktionen bauen auf dem <a href="https://github.com/awalker89/openxlsx">openxlsx-package</a> auf.</p>
<p>Per Default wird bei allen Funktionen das Logo des Statistischen Amts eingefügt und es werden die Kontaktangaben des Datashops angegeben (<code>contactdetails = statzh, logo = NULL</code>). Mit den Funktionsargumenten können die Dateinamen, Titel, Quellen sowie Metadaten spezifiziert werden. Um längere Quellen- und Metadatenangaben über mehrere Zeilen eines Arbeitsblatts zu verteilen, kann man sie in verschiedene Vektorelemente aufteilen (Beispiel: <code>c("Zeile 1, "Zeile 2", "Zeile 3")</code>. Mit dem Argument <code>grouplines</code> werden zudem vertikale Linien zwischen ausgewählten Spalten in der Excel-Tabelle eingefügt und die Spalten optisch voneinander separiert (aktuell nicht möglich bei <code><a href="../reference/datasetsXLSX.html">datasetsXLSX()</a></code>).</p>
<p><strong>quickXLSX()</strong></p>
<p>Mit der Funktion <code><a href="../reference/quickXLSX.html">quickXLSX()</a></code> kann ein Datensatz aus <code>R</code> als vorformatierte XLSX-Datei exportiert werden. Die Funktion eignet sich, um einzelne Datensätze als Exceldatei zu verschicken.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Beispiel anhand des Datensatzes 'mtcars'</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">mtcars</span>

<span class="fu"><a href="../reference/quickXLSX.html">quickXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>, 
          title <span class="op">=</span> <span class="st">"Motor trend car road tests"</span>, 
          file <span class="op">=</span> <span class="st">"motor_trend_car_road_tests"</span>, <span class="co"># '.xlsx' wird automatisch hinzugefügt</span>
          source <span class="op">=</span> <span class="st">"Source: Henderson and Velleman (1981). Building multiple regression models interactively. Biometrics, 37, 391–411."</span>,
          metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"The data was extracted from the 1974 Motor Trend US magazine and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models)."</span><span class="op">)</span>,
          contactdetails <span class="op">=</span> <span class="st">"statzh"</span>,
          grouplines <span class="op">=</span> <span class="cn">FALSE</span>,
          logo <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="figure">
<img src="output-quickXLSX.PNG" style="width:100.0%" alt=""><p class="caption">Screenshot</p>
</div>
<p><strong>splitXLSX()</strong></p>
<p>Mit der Funktion <code><a href="../reference/splitXLSX.html">splitXLSX()</a></code> kann ein Datensatz aus R in eine XLSX-Datei exportiert und auf mehrere Arbeitsblättern verteilt werden. Die Funktion ist besonders dann geeignet, wenn man einen Datensatz für verschiedene Ausprägungen einer Gruppierungsvariable (z.B. Altersklassen) separat darstellen möchte.</p>
<p>Im Beispiel unten wird ein Arbeitsblatt pro Zylinderanzahl der Autos im <code>mtcars</code>-Datensatz generiert.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Beispiel anhand des Datensatzes 'mtcars'</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">mtcars</span>

<span class="co"># Beispiel mit Standardlogo (Logo des Statistischen Amts)</span>
<span class="fu"><a href="../reference/splitXLSX.html">splitXLSX</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dat</span>,
          file <span class="op">=</span> <span class="st">"motor_trend_car_road_tests"</span>, <span class="co"># '.xlsx' wird automatisch hinzugefügt</span>
          sheetvar <span class="op">=</span> <span class="va">cyl</span>, <span class="co"># Variable, nach der die Daten auf die Tabellenblätter aufgeteilt werden sollen</span>
          source <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Source: Henderson and Velleman (1981), 
                     Building multiple regression models interactively. Biometrics, 37, 391–411."</span><span class="op">)</span>,
          metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"The data was extracted from the 1974 Motor Trend US magazine, 
                       and comprises fuel consumption and 10 aspects of automobile design and performance for 32 automobiles (1973–74 models)."</span><span class="op">)</span>,
          contactdetails <span class="op">=</span> <span class="st">"statzh"</span>,
          grouplines <span class="op">=</span> <span class="cn">FALSE</span>,
          logo <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<p><strong>datasetsXLSX() (<em>NEU</em>)</strong></p>
<p>Die Funktion datasetsXLSX() erlaubt es, mehrere Datensätze und/oder Grafiken aus R in eine XLSX-Datei zu exportieren. Pro Arbeitsblatt wird ein Datensatz oder eine Grafik dargestellt. Es kann auch eine Auftragsnummer hinzugefügt werden. Die Funktion eignet sich besonders für Fälle, wo man mehrere Datensätze an eine/n Empfänger/in verschicken möchte.</p>
<p>Die Datensätze, die zusammen in einer Excel-Datei erscheinen sollen, müssen dem Funktionsargument <code>datasets</code> als Liste übergeben werden (<code>datasets = list(dataset1, dataset2, ...)</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Beispiel mit zwei Datensätzen:</span>
<span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">mtcars</span>
<span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">PlantGrowth</span>

<span class="fu"><a href="../reference/datasetsXLSX.html">datasetsXLSX</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"twoDatasets"</span>,
             maintitle <span class="op">=</span> <span class="st">"Autos und Pflanzen"</span>, <span class="co"># '.xlsx' wird automatisch hinzugefügt</span>
             datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span>,
             sheetnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Autos"</span>,<span class="st">"Blumen"</span><span class="op">)</span>,
             titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mtcars-Datensatz"</span>,<span class="st">"PlantGrowth-Datensatz"</span><span class="op">)</span>,
             sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Source: Henderson and Velleman (1981),
                         Building multiple regression models interactively. Biometrics, 37, 391–411."</span>, 
                         <span class="st">"Dobson, A. J. (1983) An Introduction to Statistical Modelling. London: Chapman and Hall."</span><span class="op">)</span>,
             metadata1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bemerkungen zum mtcars-Datensatz: x"</span>, 
                           <span class="st">"Bemerkungen zum PlantGrowth-Datensatz: x"</span><span class="op">)</span>,
             auftrag_id<span class="op">=</span><span class="st">"A2021_0000"</span><span class="op">)</span></code></pre></div>
<p>Um eine Grafik in die Excel-Datei einzufügen, muss sie der <code>datasets</code>-Liste hinzugefügt werden: <code>datasets = list(dataset1, dataset2, grafik1)</code>.</p>
<p>Mit den Argumenten <code>startrows</code> und <code>startcols</code> kann bestimmt werden, wo im Arbeitsblatt die Grafik platziert werden soll und mit <code>widths</code> und <code>heights</code> kann man die Höhe und die Breite ajustieren (aktuell in Zoll/<em>inches</em>, 1 Zoll = 2.54 cm). Die Grösse und Position wird mittels eines Vektors bestimmt, wobei es pro Arbeitsblatt ein Vektorelement gibt. Die Vektorelemente müssen überall auf <code>= 0</code> gesetzt sein ausser bei den Visualisierungen. Bei zwei Datensätzen und einer Grafik sieht der Vektor bspw. folgendermassen aus: <code><a href="https://rdrr.io/r/base/c.html">c(0,0,4)</a></code>. Hätte man einen Datensatz und zwei Grafiken, sähe der Vektor hingegen so aus: <code><a href="https://rdrr.io/r/base/c.html">c(0,4,4)</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">mtcars</span>
<span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">PlantGrowth</span>
<span class="va">fig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">disp</span><span class="op">)</span>

<span class="fu"><a href="../reference/datasetsXLSX.html">datasetsXLSX</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"twoDatasetsandFigure"</span>,
             maintitle <span class="op">=</span> <span class="st">"Autos und Pflanzen"</span>, <span class="co"># '.xlsx' wird automatisch hinzugefügt</span>
             datasets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span>, <span class="va">fig</span><span class="op">)</span>,
             widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,
             heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>,
             startrows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>,
             startcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>,
             sheetnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Autos"</span>,<span class="st">"Blumen"</span>, <span class="st">"Histogramm"</span><span class="op">)</span>,
             titles <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mtcars-Datensatz"</span>,<span class="st">"PlantGrowth-Datensatz"</span>, <span class="st">"Histogramm"</span><span class="op">)</span>,
             sources <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Source: Henderson and Velleman (1981), 
                         Building multiple regression models interactively. Biometrics, 37, 391–411."</span>, 
                         <span class="st">"Source: Dobson, A. J. (1983) An Introduction to Statistical Modelling. London: Chapman and Hall."</span><span class="op">)</span>,
             metadata1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Bemerkungen zum mtcars-Datensatz: x"</span>, 
                           <span class="st">"Bemerkungen zum PlantGrowth-Datensatz: x"</span><span class="op">)</span>,
             auftrag_id<span class="op">=</span><span class="st">"A2021_0000"</span><span class="op">)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#formatierte-excel-tabellen-mit-r">Formatierte Excel-Tabellen mit R</a></li>
      </ul>
</div>
      <!-- codefund -->
   <!--<div id="codefund"><!-- fallback content </div> -->
<!--  <script src="https://codefund.app/properties/148/funder.js" async="async"></script>-->
  </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Andrea Schnell, Thomas Lo Russo.</p>
</div>

<style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#000000 !important;background-color:#FFFFFF !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 0px 9px !important;font-size: 17px !important;letter-spacing:-0.08px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Lato', sans-serif !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style>
<link href="https://fonts.googleapis.com/css?family=Lato&amp;subset=latin,latin-ext" rel="stylesheet">
<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
